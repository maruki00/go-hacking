package utils

import (
	"encoding/gob"
	"fmt"
	"log"
	"malware/models"
	"net"
)

func Encode(conn net.Conn, command *models.Command) error {
	gobEncoder := gob.NewEncoder(conn)
	err := gobEncoder.Encode(command)
	if err != nil {
		log.Fatal(err)
	}
	return nil
}

func Dencode(conn net.Conn) (*models.Command, error) {
	command := &models.Command{}
	gobDecoder := gob.NewDecoder(conn)
	err := gobDecoder.Decode(&command)
	if err != nil {
		fmt.Println(err.Error())
		return nil, err
	}

	return command, nil
}
